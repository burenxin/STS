webpackJsonp([4],{"5d+m":function(e,t){},P9l9:function(e,t,a){"use strict";t.a={setCookie:function(e,t,a){var r=new Date;r.setDate(r.getDate()+a),document.cookie=e+"="+t+";expires="+r},getCookie:function(e){for(var t=document.cookie.split("; "),a=0;a<t.length;a++){var r=t[a].split("=");if(r[0]===e)return r[1]}return""},clearCookie:function(e){this.setCookie(e,1,-1)},getParams:function(e){for(var t=[],a=e,r=0;r<a.length;r++)a[r].startArea=a[r].startArea+a[r].startAreaMx,a[r].endArea=a[r].endArea+a[r].endAreaMx,t.push(a[r]);return t}}},R9OX:function(e,t){},Z8O0:function(e,t){},j3So:function(e,t){},y9bZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("P9l9"),s={name:"packTask",props:["orderDetail","pageTotle","pageSize"],data:function(){return{orderIds:[],options3:[{value:"1",label:"普通运输"},{value:"0",label:"冷藏品"}],transportType:"",startTime:"",endTime:"",startArea:"",endArea:"",currentPage:1,loadSign:!0,address:{startProvice:"",startCity:"",sarea:""},endaddress:{endProvice:null,endCity:null,endarea:null}}},watch:{address:{handler:function(e){e.sarea?(this.startArea=e.startProvice+"-"+e.startCity+"-"+e.sarea,this.startArea="省-市-区"===this.startArea?"":this.startArea):e.startCity?this.startArea=e.startProvice+"-"+e.startCity:this.startArea=e.startProvice},deep:!0},endaddress:{handler:function(e){e.endarea?(this.endArea=e.endProvice+"-"+e.endCity+"-"+e.endarea,this.endArea="省-市-区"===this.endArea?"":this.endArea):e.endCity?this.endArea=e.endProvice+"-"+e.endCity:this.endArea=e.endProvice},deep:!0}},directives:{loadmore:{bind:function(e,t){e.querySelector(".el-table__body-wrapper").addEventListener("scroll",function(){this.scrollHeight-this.scrollTop-this.clientHeight<5&&t.value()})}}},methods:{getRowClass:function(e){e.row,e.column;var t=e.rowIndex;e.columnIndex;return 0===t?"background:#EFEFEF":""},showDetail:function(e){this.$emit("godetail",e)},onChangeCity:function(e){this.address.startCity=e.value},onChangeProvince:function(e){this.address.startProvice=e.value},onChangeArea:function(e){this.address.sarea=e.value},ChangeCity:function(e){this.endaddress.endCity=e.value},ChangeProvince:function(e){this.endaddress.endProvice=e.value},ChangeArea:function(e){this.endaddress.endarea=e.value},selection:function(e){var t=this;this.orderIds=[],e.forEach(function(e,a){t.orderIds.push(e.orderId)})},pack:function(){var e=this;this.$post("/api/orderHandler/buildTask",this.orderIds).then(function(t){t&&t.success?(e.$message({message:"打包成功",type:"success"}),e.orderIds.forEach(function(t){e.orderDetail.forEach(function(a,r){a.orderId===t&&e.orderDetail.splice(r,1)})})):e.$message.error(t.message)})},search:function(){var e=this,t={order:{transportType:this.transportType,startArea:this.startArea,endArea:this.endArea},startTime:this.startTime,endTime:this.endTime,pageCode:1,pageSize:this.pageSize};this.$post("/api/orderHandler/findOrders",t).then(function(t){e.pageTotle=t.total,e.currentPage=1,e.orderDetail=[],console.log(t);var a=t.rows;e.orderDetail=r.a.getParams(a)})},loadMore:function(){var e=this;if(this.loadSign){this.loadSign=!1,this.currentPage++;var t=Math.floor(this.pageTotle/this.pageSize);if(console.log(t),this.currentPage>t)return;setTimeout(function(){e.loadSign=!0},1e3);var a={pageCode:this.currentPage,pageSize:this.pageSize};this.$post("/api/orderHandler/findOrders",a).then(function(t){var a=t.rows;r.a.getParams(a).forEach(function(t){e.orderDetail.push(t)}),console.log(e.orderDetail)})}},autoPack:function(){var e=this,t={order:{transportType:this.transportType,startArea:this.startArea,endArea:this.endArea},startTime:this.startTime,endTime:this.endTime,pageCode:this.currentPage,pageSize:this.pageSize};this.$post("/api/orderHandler/autoBuildTask",t).then(function(t){if(console.log(t),t&&t.success){e.$message({message:"打包成功",type:"success"}),e.currentPage=1,e.orderDetail=[];var a={pageCode:e.currentPage,pageSize:e.pageSize};e.$post("/api/orderHandler/findOrders",a).then(function(t){console.log(t);var a=t.rows;e.pageTotle1=t.total,e.orderDetail=r.a.getParams(a)})}else e.$message.error("打包失败")})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"packTask"},[a("div",{staticClass:"operate"},[a("el-form",{attrs:{inline:!0}},[a("el-row",[a("el-col",{attrs:{span:8,offset:1}},[a("el-form-item",{attrs:{label:"运输类型",prop:"transportType"}},[a("el-select",{attrs:{clearable:""},model:{value:e.transportType,callback:function(t){e.transportType=t},expression:"transportType"}},e._l(e.options3,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"起始日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"起始日期","value-format":"yyyy-MM-dd"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"结束日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8,offset:1}},[a("el-form-item",{staticClass:"address",attrs:{label:"寄件地址"}},[a("v-distpicker",{on:{province:e.onChangeProvince,city:e.onChangeCity,area:e.onChangeArea}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"address",attrs:{label:"收件地址"}},[a("v-distpicker",{on:{province:e.ChangeProvince,city:e.ChangeCity,area:e.ChangeArea}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4,offset:1}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.pack}},[e._v("打包")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.autoPack}},[e._v("一键打包")])],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"orderList"},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{data:e.orderDetail,align:"center","max-height":"350","header-cell-style":e.getRowClass},on:{"cell-dblclick":e.showDetail,"selection-change":e.selection}},[a("el-table-column",{attrs:{type:"selection",width:"55"},on:{"selection-change":e.selection}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderNum",align:"center",label:"订单号",width:"170","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"transportType",align:"center",label:"运输类型",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodsCount",align:"center",label:"总件数",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"volume",align:"center",label:"总体积(m³)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weight",align:"center",label:"总重量(kg)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"startArea",align:"center",label:"起始地址",width:"250","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"endArea",align:"center",label:"收货地址",width:"250","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"receivingTime",align:"center",label:"送达时间","show-overflow-tooltip":""}})],1)],1)])},staticRenderFns:[]};var n={name:"orderPub",props:["packList","pageTotle","pageSize"],data:function(){return{TaskIds:[],currentPage:1}},methods:{handleDeletOrder:function(e,t,a){var r=this;console.log(e);var s={bidTaskId:t.bidTaskId,removeOrderIds:e};this.$post("/api/orderHandler/demolitionOrder",s).then(function(e){e&&e.success?(r.packList.forEach(function(e,s){e.bidTaskId===t.bidTaskId&&(e.orderList.splice(a,1),0===e.orderList.length&&r.packList.splice(s,1))}),r.$message({message:"拆单成功",type:"success"})):r.$message.error("拆单失败")})},selections:function(e){var t=this;console.log(e),this.TaskIds=[],e.forEach(function(e,a){t.TaskIds.push(e.bidTaskId)})},openTask:function(){var e=this,t={bidTaskId:this.TaskIds.join(","),removeOrderIds:null};this.$post("/api/orderHandler/demolitionOrder",t).then(function(t){t&&t.success?(e.TaskIds.forEach(function(t){e.packList.forEach(function(a,r){a.bidTaskId===t&&e.packList.splice(r,1)})}),e.TaskIds=[],e.$message({message:"拆包成功",type:"success"})):(e.$message.error(t.message),e.TaskIds=[])})},taskPublish:function(){var e=this;this.$post("/api/orderHandler/taskIssue",this.TaskIds).then(function(t){t&&t.success?(e.$message({message:"任务单发布成功",type:"success"}),e.TaskIds.forEach(function(t){e.packList.forEach(function(a,r){a.bidTaskId===t&&e.packList.splice(r,1)})})):e.$message.error(t.message)})},handleCurrentChange:function(e){var t=this;this.currentPage=e;var a={pageCode:this.currentPage,pageSize:this.pageSize};this.$post("/api/orderHandler/findTask",a).then(function(e){console.log(e),t.packList=e.rows,t.pageTotle=e.total})},getRowClass:function(e){e.row,e.column;var t=e.rowIndex;e.columnIndex;return 0===t?"background:#EFEFEF":""}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"orderPub"},[a("div",{staticClass:"operate"},[a("el-button",{on:{click:e.taskPublish}},[e._v("发布")]),e._v(" "),a("el-button",{on:{click:e.openTask}},[e._v("拆包")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.packList,align:"center","header-cell-style":e.getRowClass},on:{"selection-change":e.selections}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.orderList,function(r,s){return a("el-form",{key:r.orderId,staticClass:"orderlist",attrs:{"label-position":"left",inline:""}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"订单号:"}},[a("span",[e._v(e._s(r.orderNum))])])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"提货时间:"}},[a("span",[e._v(e._s(r.deliveryTime))])])],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-form-item",{attrs:{label:"运输类型:"}},[a("span",[e._v(e._s(r.transportType))])])],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-form-item",{attrs:{label:"总件数:"}},[a("span",[e._v(e._s(r.goodsCount))])])],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-form-item",{attrs:{label:"总体积:"}},[a("span",[e._v(e._s(r.volume))])])],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-form-item",{attrs:{label:"总重量:"}},[a("span",[e._v(e._s(r.weight))])])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"起始地址:"}},[a("span",[e._v(e._s(r.startArea))])])],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"目的地址:"}},[a("span",[e._v(e._s(r.endArea))])])],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"danger"},on:{click:function(a){e.handleDeletOrder(r.orderId,t.row,s)}}},[e._v("拆单")])],1)],1)],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"},on:{"selection-change":e.selections}}),e._v(" "),a("el-table-column",{attrs:{prop:"bidTaskNum",align:"center",label:"任务单号",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"taskType",align:"center",label:"运输类型",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalQuantity",align:"center",label:"总件数",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalVolume",align:"center",label:"总体积(m³)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"totalWeight",align:"center",label:"总重量(kg)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"serviceTime",align:"center",label:"送达时间",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pickArea",align:"center",label:"起始地址",width:"200","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliverArea",align:"center",label:"收货地址","show-overflow-tooltip":""}})],1),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.pageTotle,"page-size":e.pageSize,"current-page":e.currentPage},on:{"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"orderDetail"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.packDetail,align:"center"}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderNum",align:"center",label:"订单号",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"consignor",align:"center",label:"寄件人姓名",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phoneNumConsignor",align:"center",label:"联系电话",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"consignee",align:"center",label:"收件人姓名",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phoneNumConsignee",align:"center",label:"联系电话",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodsType",align:"center",label:"商品类型",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"transportType",align:"center",label:"运输类型",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodsCount",align:"center",label:"总件数",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"volume",align:"center",label:"总体积(m³)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weight",align:"center",label:"总重量(kg)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"receivingTime",align:"center",label:"送达时间",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryTime",align:"center",label:"上门时间",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"transportPrices",align:"center",label:"预计费用(元)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"endArea",align:"center",label:"起始地址",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"endArea",align:"center",label:"目的地址",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",align:"center",label:"备注",width:"150"}})],1)],1)},staticRenderFns:[]};var c={name:"pack",components:{packTask:a("VU/8")(s,l,!1,function(e){a("Z8O0")},"data-v-67fa6c64",null).exports,orderPub:a("VU/8")(n,o,!1,function(e){a("j3So")},"data-v-47886726",null).exports,orderDetail:a("VU/8")({props:["activeRow"],data:function(){return{packDetail:[]}},watch:{activeRow:function(){this.packDetail=[],this.packDetail.push(this.activeRow)}}},i,!1,function(e){a("5d+m")},"data-v-00ce8744",null).exports},mounted:function(){var e=this;console.log("a");var t={pageCode:this.pageCode,pageSize:this.pageSize2};this.$post("/api/orderHandler/findOrders",t).then(function(t){console.log(t);var a=t.rows;e.pageTotle1=t.total,e.orderDetail=r.a.getParams(a)})},data:function(){return{activeName:"first",pageCode:1,pageSize1:7,pageSize2:10,packList:[],orderDetail:[],pageTotle1:null,pageTotle:null,activeRow:{},isRouterAlive:!0}},methods:{godetail:function(e){this.activeName="third",this.activeRow=e},handleGetTask:function(){var e=this;if("second"===this.activeName){var t={pageCode:this.pageCode,pageSize:this.pageSize1};this.$post("/api/orderHandler/findTask",t).then(function(t){var a=t.rows;e.packList=a,e.pageTotle=t.total})}if("first"===this.activeName){var a={pageCode:this.pageCode,pageSize:this.pageSize2};this.$post("/api/orderHandler/findOrders",a).then(function(t){console.log(t);var a=t.rows;e.pageTotle1=t.total,e.orderDetail=r.a.getParams(a)})}}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pack"},[a("div",{staticClass:"currentPage"},[e._v("当前页面：订单处理")]),e._v(" "),a("div",{staticClass:"tabTool"},[a("el-tabs",{on:{"tab-click":e.handleGetTask},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"任务打包",name:"first"}},[a("pack-task",{attrs:{orderDetail:e.orderDetail,pageTotle:e.pageTotle1,pageSize:e.pageSize2},on:{godetail:e.godetail}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"任务单发布",name:"second"}},[a("order-pub",{attrs:{packList:e.packList,pageTotle:e.pageTotle,pageSize:e.pageSize1}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"订单详情",name:"third",disabled:""}},[a("order-detail",{attrs:{activeRow:e.activeRow}})],1)],1)],1)])},staticRenderFns:[]};var p=a("VU/8")(c,d,!1,function(e){a("R9OX")},"data-v-37a4edc6",null);t.default=p.exports}});