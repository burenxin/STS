webpackJsonp([5],{"2Yso":function(e,t){},Ow59:function(e,t){},Pp9j:function(e,t){},SC19:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"orderDetail",props:["Order","isdisabled"],inject:["reload"],data:function(){var e=function(e,t,r){if(!t)return r(new Error("请输入联系方式"));if(!/^1[3|4|5|7|8][0-9]\d{8}$/.test(t))return r(new Error("请输入正确手机号"));r()},t=function(e,t,r){if(!t)return r(new Error("必填内容"));if(!/(^[1-9]{1}[0-9]*$)|(^[0-9]*\.[0-9]{2}$)|(^[0-9]*\.[0-9]{1}$)/.test(t))return r(new Error("数字不合法"));r()};return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},hideOk:!1,hideOk1:!1,options1:[{value:"0",label:"中药"},{value:"1",label:"西药"},{value:"2",label:"器械"},{value:"3",label:"生活用品"}],options2:[{value:"0",label:"无需返单"},{value:"1",label:"签收单传真返回"},{value:"2",label:"签收单原件返回"}],options3:[{value:"1",label:"普通运输"},{value:"0",label:"冷藏车"}],options4:[{value:"0",label:"3天内"},{value:"1",label:"3-5天"},{value:"2",label:"5-7天"}],Order:{consignor:"",consignee:"",phoneNumConsignor:"",phoneNumConsignee:"",startArea:"",startAreaMx:"",endArea:"",endAreaMx:"",weight:"",volume:"",goodsCount:"",goodsType:"",deliveryTime:"",remark:"",receivingTime:"",transportPrices:0,transportType:"",signatureType:"",userId:""},rules:{consignor:[{required:!0,message:"请输入寄件人人姓名",trigger:"blur"},{max:10,message:"长度在20个字符以内",trigger:"blur"}],consignee:[{required:!0,message:"请输入收件人人姓名",trigger:"blur"},{max:10,message:"长度在20个字符以内",trigger:"blur"}],phoneNumConsignor:[{required:!0,trigger:"blur",validator:e}],phoneNumConsignee:[{required:!0,trigger:"blur",validator:e}],goodsName:[{required:!0,message:"请选择物品类型",trigger:"blur"}],weight:[{required:!0,validator:t,trigger:"blur"}],volume:[{required:!0,validator:t,trigger:"blur"}],goodsCount:[{required:!0,validator:t,trigger:"blur"}],goodsType:[{required:!0,message:"请选择运输类型",trigger:"blur"}],startArea:[{required:!0,message:"请选择城市",trigger:"blur"}],endArea:[{required:!0,message:"请选择城市",trigger:"blur"}],startAreaMx:[{required:!0,message:"请输入详细街道",trigger:"blur"}],endAreaMx:[{required:!0,message:"请输入详细街道",trigger:"blur"}]}}},computed:{computedPrice:function(){this.Order.userId=sessionStorage.getItem("userId");var e=this.Order;return{startArea:e.startArea,endArea:e.endArea,goodsCount:e.goodsCount,volume:e.volume,weight:e.weight,goodsType:e.goodsType,userId:e.userId}}},watch:{computedPrice:function(e){var t=this;console.log(e),e.volume&&e.goodsCount&&e.weight&&e.startArea&&e.endArea?this.$get("/api/price/getPrice",e,{showLoading:!1}).then(function(e){t.$set(t.Order,"transportPrices",e.transportPrices)}):this.$set(this.Order,"transportPrices",0)}},methods:{changehide:function(){this.hideOk=!this.hideOk},onSelected:function(e){var t=e.province.value+"-"+e.city.value+"-"+e.area.value;this.$set(this.Order,"startArea",t),this.hideOk=!this.hideOk},changehide1:function(){this.hideOk1=!this.hideOk1},onSelected1:function(e){var t=e.province.value+"-"+e.city.value+"-"+e.area.value;this.$set(this.Order,"endArea",t),this.hideOk1=!this.hideOk1},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.Order.userId=sessionStorage.getItem("userId"),t.$post("/api/order/create",t.Order).then(function(e){e&&(t.$emit("changeActiveName"),t.reload())})})}}},s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"detail"},[r("el-form",{ref:"Order",attrs:{model:e.Order,rules:e.rules,disabled:e.isdisabled}},[r("div",{staticClass:"area address"},[r("div",{staticClass:"classify"},[e._v("收发货地址")]),e._v(" "),r("el-row",{staticClass:"row"},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"寄件人姓名",prop:"consignor"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入寄件人姓名"},model:{value:e.Order.consignor,callback:function(t){e.$set(e.Order,"consignor",t)},expression:"Order.consignor"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收件人姓名",prop:"consignee"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入收件人人姓名"},model:{value:e.Order.consignee,callback:function(t){e.$set(e.Order,"consignee",t)},expression:"Order.consignee"}})],1)],1)],1),e._v(" "),r("el-row",{staticClass:"row"},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"联系电话",prop:"phoneNumConsignor"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入手机号"},model:{value:e.Order.phoneNumConsignor,callback:function(t){e.$set(e.Order,"phoneNumConsignor",t)},expression:"Order.phoneNumConsignor"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"联系电话",prop:"phoneNumConsignee"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入手机号"},model:{value:e.Order.phoneNumConsignee,callback:function(t){e.$set(e.Order,"phoneNumConsignee",t)},expression:"Order.phoneNumConsignee"}})],1)],1)],1),e._v(" "),r("el-row",{staticClass:"row"},[r("el-col",{staticClass:"addressRow",attrs:{span:12}},[r("el-form-item",{staticClass:"l-address",attrs:{label:"寄件地址",prop:"startArea"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.hideOk,expression:"hideOk"}],staticClass:"hideAddress"},[r("p",[e._v("选择寄送地址")]),e._v(" "),r("v-distpicker",{on:{selected:e.onSelected}})],1),e._v(" "),r("div",{staticClass:"m-a",on:{click:e.changehide}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"请选择城市"},model:{value:e.Order.startArea,callback:function(t){e.$set(e.Order,"startArea",t)},expression:"Order.startArea"}})],1)]),e._v(" "),r("el-form-item",{staticClass:"AreaDetail",attrs:{prop:"startAreaMx"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"详细街道"},model:{value:e.Order.startAreaMx,callback:function(t){e.$set(e.Order,"startAreaMx",t)},expression:"Order.startAreaMx"}})],1)],1),e._v(" "),r("el-col",{staticClass:"addressRow",attrs:{span:12}},[r("el-form-item",{staticClass:"l-address",attrs:{label:"收件地址",prop:"endArea"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.hideOk1,expression:"hideOk1"}],staticClass:"hideAddress"},[r("p",[e._v("选择寄送地址")]),e._v(" "),r("v-distpicker",{on:{selected:e.onSelected1}})],1),e._v(" "),r("div",{staticClass:"m-a",on:{click:e.changehide1}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"请选择城市"},model:{value:e.Order.endArea,callback:function(t){e.$set(e.Order,"endArea",t)},expression:"Order.endArea"}})],1)]),e._v(" "),r("el-form-item",{staticClass:"AreaDetail",attrs:{prop:"endAreaMx"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"详细街道"},model:{value:e.Order.endAreaMx,callback:function(t){e.$set(e.Order,"endAreaMx",t)},expression:"Order.endAreaMx"}})],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"area sendInfo"},[r("div",{staticClass:"classify"},[e._v("寄托物信息")]),e._v(" "),r("el-row",{staticClass:"row"},[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"商品类型",prop:"goodsType"}},[r("el-select",{model:{value:e.Order.goodsType,callback:function(t){e.$set(e.Order,"goodsType",t)},expression:"Order.goodsType"}},e._l(e.options1,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"重量(kg)",prop:"weight"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"重量"},model:{value:e.Order.weight,callback:function(t){e.$set(e.Order,"weight",t)},expression:"Order.weight"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"体积",prop:"volume"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"0-999"},model:{value:e.Order.volume,callback:function(t){e.$set(e.Order,"volume",t)},expression:"Order.volume"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"件数",prop:"goodsCount"}},[r("el-input",{staticClass:"input-box",attrs:{placeholder:"件"},model:{value:e.Order.goodsCount,callback:function(t){e.$set(e.Order,"goodsCount",t)},expression:"Order.goodsCount"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"运输类型",prop:"transportType"}},[r("el-select",{model:{value:e.Order.transportType,callback:function(t){e.$set(e.Order,"transportType",t)},expression:"Order.transportType"}},e._l(e.options3,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"area serviceInfo"},[r("div",{staticClass:"classify"},[e._v("服务信息")]),e._v(" "),r("el-row",{staticClass:"row"},[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"提货时间"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH-mm-ss","picker-options":e.pickerOptions},model:{value:e.Order.deliveryTime,callback:function(t){e.$set(e.Order,"deliveryTime",t)},expression:"Order.deliveryTime"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"签收单"}},[r("el-select",{model:{value:e.Order.signatureType,callback:function(t){e.$set(e.Order,"signatureType",t)},expression:"Order.signatureType"}},e._l(e.options2,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"预计送达时间"}},[r("el-select",{model:{value:e.Order.receivingTime,callback:function(t){e.$set(e.Order,"receivingTime",t)},expression:"Order.receivingTime"}},e._l(e.options4,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),r("el-row",{staticClass:"row"},[r("el-col",{attrs:{span:12}},[r("el-form-item",{staticClass:"remark",attrs:{label:"备注"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.Order.remark,callback:function(t){e.$set(e.Order,"remark",t)},expression:"Order.remark"}})],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"submit"},[r("p",[e._v("预估总价"),r("span",{staticClass:"price",domProps:{textContent:e._s(e.Order.transportPrices)}}),e._v("元")]),e._v(" "),r("el-button",{staticClass:"submitBtn",on:{click:function(t){e.submitForm("Order")}}},[e._v("提交")])],1)])],1)},staticRenderFns:[]};var i={name:"orderList",props:["time"],data:function(){return{orderDetail:[],orderList:[],currentPage:1,pageSize:7,pageTotle:null}},watch:{time:function(){var e=this,t={createdTime:this.time,pageSize:this.pageSize,pageCode:this.currentPage,userId:sessionStorage.getItem("userId")};this.$get("/api/order/findByConPage",t).then(function(t){console.log(t),e.orderList=[],e.orderDetail=[];var r=t.rows;e.pageTotle=t.total;for(var a=0;a<r.length;a++)e.orderList.push(r[a]),r[a].endArea=r[a].endArea+r[a].endAreaMx,e.orderDetail.push(r[a])})}},mounted:function(){var e=this,t={createdTime:null,pageSize:this.pageSize,pageCode:this.currentPage,userId:sessionStorage.getItem("userId")};this.$get("/api/order/findByConPage",t).then(function(t){console.log(t);var r=t.rows;e.pageTotle=t.total;for(var a=0;a<r.length;a++)e.orderList.push(r[a]),r[a].endArea=r[a].endArea+r[a].endAreaMx,e.orderDetail.push(r[a])})},methods:{showDetail:function(e,t){this.$emit("godetail",e)},handleDelete:function(e,t){var r=this;"刚生成"===t.status?this.$confirm("确定要取消该订单吗？？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){r.$post("/api/order//deleteOrder",{orderId:t.orderId,status:t.status}).then(function(t){t&&t.success&&(r.orderDetail.splice(e,1),r.$message({type:"success",message:"已取消当前订单"}))})}):this.$alert("当前订单已经不能取消",{confirmButtonText:"确定",type:"warning"})},handleCurrentChange:function(e){var t=this;this.currentPage=e;var r={order:{Consignee:null},pageSize:this.pageSize,pageCode:this.currentPage};this.$get("/api/order/findByConPage",r).then(function(e){var r=e.rows;t.pageTotle=e.total,t.orderDetail=[];for(var a=0;a<r.length;a++)t.orderList.push(r[a]),r[a].endArea=r[a].endArea+r[a].endAreaMx,t.orderDetail.push(r[a])})}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"orderList"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderDetail,align:"center"},on:{"row-dblclick":e.showDetail}},[r("el-table-column",{attrs:{prop:"createdTime",align:"center",label:"下单时间",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"transportType",align:"center",label:"运输类型",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"weight",align:"center",label:"总重量(kg)",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{prop:"volume",align:"center",label:"总体积(m³)",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{prop:"consignee",align:"center",label:"收件人",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"phoneNumConsignee",align:"center",label:"联系方式",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"endArea",align:"center",label:"收货地址",width:"300","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"status",align:"center",label:"运单状态",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){e.handleDelete(t.$index,t.row)}}},[e._v("取消订单")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.pageTotle,"page-size":e.pageSize,"current-page":e.currentPage},on:{"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var o={name:"order",components:{orderDetail:r("VU/8")(a,s,!1,function(e){r("2Yso")},"data-v-584f8ae8",null).exports,orderList:r("VU/8")(i,l,!1,function(e){r("Pp9j")},"data-v-72e0032c",null).exports},provide:function(){return{reload:this.reload}},data:function(){return{time1:"",ishide:!1,activeName:"first",order:{},isRouterAlive:!0}},methods:{addOrder:function(){this.activeName="second",this.ishide=!1,this.order={transportType:"0",signatureType:"0",receivingTime:"0"}},addOrderDetail:function(e){this.activeName="second",this.order=e,this.ishide=!0},addList:function(){this.activeName="first"},reload:function(){this.isRouterAlive=!1,this.$nextTick(function(){this.isRouterAlive=!0})}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order"},[r("div",{staticClass:"currentPage"},[e._v("当前页面：在线下单")]),e._v(" "),r("div",{staticClass:"toolBar"},[r("button",{staticClass:"btn addBtn",on:{click:e.addOrder}},[r("i",{staticClass:"el-icon-plus addIcon"}),e._v("新增\n    ")]),e._v(" "),r("div",{staticClass:"data"},[r("el-date-picker",{staticClass:"choiceData",attrs:{type:"date",placeholder:"选择查询日期","value-format":"yyyy-MM-dd"},model:{value:e.time1,callback:function(t){e.time1=t},expression:"time1"}})],1)]),e._v(" "),r("el-tabs",{staticClass:"toolTab",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"订单列表",name:"first"}},[e.isRouterAlive?r("order-list",{attrs:{time:e.time1},on:{godetail:e.addOrderDetail}}):e._e()],1),e._v(" "),r("el-tab-pane",{attrs:{label:"订单详情",name:"second",disabled:""}},[r("order-detail",{attrs:{Order:e.order,isdisabled:e.ishide},on:{changeActiveName:e.addList}})],1)],1)],1)},staticRenderFns:[]};var d=r("VU/8")(o,n,!1,function(e){r("Ow59")},"data-v-59c931b0",null);t.default=d.exports}});