webpackJsonp([2],{"/H0L":function(t,a,e){"use strict";var i={data:function(){return{page:1}},props:{total:Number},methods:{handleSizeChange:function(){this.$emit("handleToPage",this.page)},handleCurrentChange:function(){this.$emit("handleToPage",this.page)}},mounted:function(){}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"pick-data"},[e("el-pagination",{attrs:{"current-page":t.page,"page-size":10,layout:"prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(a){t.page=a}}})],1)},staticRenderFns:[]};var l=e("VU/8")(i,s,!1,function(t){e("NXWi")},"data-v-10843f61",null);a.a=l.exports},"3Y5c":function(t,a){},NXWi:function(t,a){},Q5f7:function(t,a){},cfat:function(t,a){},ieqo:function(t,a){},kR9e:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("Dd8w"),s=e.n(i),l=e("NYxO"),n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"search-bar"},[e("div",{staticClass:"search-box"},[e("div",{staticClass:"task-order item"},[e("span",{staticClass:"label"},[t._v("任务单号")]),t._v(" "),e("el-input",{attrs:{placeholder:"请输入任务单号"},model:{value:t.bidTaskId,callback:function(a){t.bidTaskId=a},expression:"bidTaskId"}})],1),t._v(" "),e("div",{staticClass:"task-type item data"},[e("span",{staticClass:"label"},[t._v("时间")]),t._v(" "),e("el-date-picker",{attrs:{type:"date",placeholder:"请选择开始时间"},model:{value:t.releaseTime,callback:function(a){t.releaseTime=a},expression:"releaseTime"}}),t._v(" "),e("span",[t._v(" ")]),t._v(" "),e("el-date-picker",{attrs:{type:"date",placeholder:"请选择结束时间"},model:{value:t.sealedDiskTime,callback:function(a){t.sealedDiskTime=a},expression:"sealedDiskTime"}})],1),t._v(" "),e("div",{staticClass:"task-type item"},[e("span",{staticClass:"label"},[t._v("状态")]),t._v(" "),e("el-select",{attrs:{placeholder:"请选择任务单状态",clearable:""},model:{value:t.bidStatus,callback:function(a){t.bidStatus=a},expression:"bidStatus"}},t._l(t.stateOptions,function(t){return e("el-option",{key:t.stateValue,attrs:{label:t.stateLabel,value:t.stateValue}})}))],1),t._v(" "),e("div",{staticClass:"task-type item final"},[e("span",{staticClass:"label"},[t._v("类型")]),t._v(" "),e("el-select",{attrs:{placeholder:"请选择任务单类型",clearable:""},model:{value:t.taskType,callback:function(a){t.taskType=a},expression:"taskType"}},t._l(t.typeOptions,function(t){return e("el-option",{key:t.typeValue,attrs:{label:t.typeLabel,value:t.typeValue}})}))],1),t._v(" "),e("div",{staticClass:"btn"},[e("el-button",{staticClass:"searchbtn",attrs:{size:"mini"},on:{click:t.handleSearch}},[t._v("查询")])],1)])])},staticRenderFns:[]};var r=e("VU/8")({data:function(){return{bidTaskId:"",typeOptions:[{typeValue:"0",typeLabel:"冷藏品"},{typeValue:"1",typeLabel:"普通"}],taskType:"",sealedDiskTime:"",releaseTime:"",stateOptions:[{stateValue:"1",stateLabel:"竞价中"},{stateValue:"0",stateLabel:"流拍"},{stateValue:"2",stateLabel:"竞拍成功"},{stateValue:"5",stateLabel:"配送中"},{stateValue:"4",stateLabel:"配送完成"}],bidStatus:""}},methods:{handleSearch:function(){var t={bidTaskId:this.bidTaskId,taskType:this.taskType,releaseTime:this.releaseTime,sealedDiskTime:this.sealedDiskTime,bidStatus:this.bidStatus};this.$emit("searchTask",t)}}},n,!1,function(t){e("cfat")},"data-v-01b59898",null).exports,o={data:function(){return{showCompany:!1,currentBiddingRow:"",TaskHeader:[{prop:"bidTaskNum",label:"任务单号",width:"180",tooltip:!1},{prop:"releaseTime",label:"任务单时间",width:"180",tooltip:!1},{prop:"pickArea",label:"起始地",width:"160",tooltip:!0},{prop:"deliverArea",label:"目的地",width:"160",tooltip:!0},{prop:"taskType",label:"类型",width:"160",tooltip:!1},{prop:"serviceTime",label:"时效(h)",width:"120",tooltip:!1},{prop:"totalQuantity",label:"件数",width:"120",tooltip:!1},{prop:"totalWeight",label:"总重量(kg)",width:"140",tooltip:!1},{prop:"totalVolume",label:"总体积(m³)",width:"140",tooltip:!1},{prop:"proposedPrice",label:"参考价(元)",width:"140",tooltip:!1},{prop:"transactionPrice",label:"已拍价(元)",width:"140",tooltip:!1},{prop:"userId",label:"承运商",width:"160",tooltip:!0},{prop:"bidStatus",label:"任务单状态",width:"150",tooltip:!1}]}},props:{taskdata:Array,companydata:Array},methods:{handleShowCompany:function(){"流拍"===this.currentBiddingRow.bidStatus?(this.$emit("handleToShowCompany",this.currentBiddingRow),this.showCompany=!0):this.$message({type:"warning",message:"只有流拍任务单可以指派内部承运商"})},handleSelectCompany:function(t){var a=this;this.$confirm("是否指派此承运商运输此任务单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$emit("handleToCompany",a.currentBiddingRow.bidTaskId,t),a.showCompany=!1}).catch(function(){a.$message({type:"info",message:"已取消此任务单指派"}),a.showCompany=!1})},biddingCurrentSelect:function(t){t&&("流拍"===t.bidStatus?(document.getElementsByClassName("orderbtn")[0].style.backgroundColor="#105faa",document.getElementsByClassName("orderbtn")[0].style.borderColor="#105faa",this.currentBiddingRow=t):(document.getElementsByClassName("orderbtn")[0].style.backgroundColor="#6aa2d8",document.getElementsByClassName("orderbtn")[0].style.borderColor="#6aa2d8",this.currentBiddingRow=""))},handleCurrentChange:function(t){this.$emit("handleToDetail",t.bidTaskId,t.bidTaskNum)}}},d={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"Task-bar"},[e("div",{staticClass:"btn"},[e("el-button",{staticClass:"orderbtn",attrs:{size:"mini"},on:{click:t.handleShowCompany}},[t._v("指派")])],1),t._v(" "),e("el-table",{staticClass:"task_table",attrs:{"max-height":"385",data:t.taskdata,"empty-text":" ","highlight-current-row":""},on:{"row-dblclick":t.handleCurrentChange,"current-change":t.biddingCurrentSelect}},t._l(t.TaskHeader,function(t,a){return e("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,width:t.width,"show-overflow-tooltip":t.tooltip}})})),t._v(" "),e("el-dialog",{attrs:{title:"可指派内部承运商",visible:t.showCompany,width:"510px",top:"25vh"},on:{"update:visible":function(a){t.showCompany=a}}},[e("el-table",{attrs:{data:t.companydata,"max-height":"350","highlight-current-row":""},on:{"row-dblclick":t.handleSelectCompany}},[e("el-table-column",{attrs:{property:"address",label:"承运商",width:"300","show-overflow-tooltip":""}}),t._v(" "),e("el-table-column",{attrs:{property:"weightPrice",label:"运输价格（元）",width:"150"}})],1)],1)],1)},staticRenderFns:[]};var c=e("VU/8")(o,d,!1,function(t){e("ieqo")},"data-v-b15fea0e",null).exports,p={data:function(){return{DetailHeader:[{prop:"userId",label:"承运商",width:"300",tooltip:!0},{prop:"quotedPrice",label:"竞拍价(元)",width:"120",tooltip:!1}]}},props:{detailOrder:String,detailNum:Number,detailData:Array,detailCompany:String,detailPrice:Number}},u={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"detail-bar"},[e("div",{staticClass:"detail-title"},[e("div",{staticClass:"detail-leader"},[t._v("当前位置： 任务单 / 详情")]),t._v(" "),e("div",{staticClass:"detail-total"},[t._v("\n      任务单号:\n      "),e("span",{staticClass:"detail-num"},[t._v(t._s(t.detailOrder))])])]),t._v(" "),e("el-table",{staticClass:"detail_table",attrs:{"max-height":"385",data:t.detailData}},t._l(t.DetailHeader,function(t,a){return e("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,width:t.width,"show-overflow-tooltip":t.tooltip}})})),t._v(" "),e("div",{staticClass:"detail-result"},[e("div",{staticClass:"lefts"},[t._v("\n      共:\n      "),e("span",[t._v(t._s(t.detailNum))]),t._v("\n        家承运商参与竞拍\n    ")]),t._v(" "),e("div",[t._v("\n      结果:\n      "),e("span",[t._v(t._s(t.detailCompany))]),t._v("成功接单，运输价格为：\n      "),e("span",[t._v(t._s(t.detailPrice))]),t._v("元\n    ")])])],1)},staticRenderFns:[]};var h={name:"manage",data:function(){return{pageCode:1,condition:{bidTaskId:"",taskType:"",releaseTime:"",sealedDiskTime:"",bidStatus:""},tasktotal:0,detailOrder:"",detailNum:0,detailCompany:"无",detailPrice:0,detailData:[],companydata:[],taskdata:[],activeName:"task"}},components:{SearchBar:r,TaskBar:c,DetailBar:e("VU/8")(p,u,!1,function(t){e("Q5f7")},"data-v-86530626",null).exports,PickData:e("/H0L").a},computed:s()({},Object(l.d)({userId:"userId"})),watch:{refreshdata:"refreshData"},methods:{showDetail:function(t,a){this.activeName="detail",this.detailOrder=a,this.detailAjax(t)},changePage:function(t){this.pageCode=t,this.taskAjax(this.userId,this.pageCode,this.condition)},searchTask:function(t){this.condition=t,this.taskAjax(this.userId,this.pageCode,this.condition)},taskAjax:function(t,a,e){var i=this,s={userId:t,pageCode:a,bidTaskId:e.bidTaskId,taskType:e.taskType,releaseTime:e.releaseTime,sealedDiskTime:e.sealedDiskTime,bidStatus:e.bidStatus};this.$get("/api/auctionTask/biddeTask",s).then(function(t){if(void 0!==t.rows){i.taskdata=t.rows;for(var a=0;a<i.taskdata.length;a++)"配送完成"===i.taskdata[a].bidTaskId&&(i.taskdata[a].serviceTime="-");i.tasktotal=t.total}})},detailAjax:function(t){var a=this;this.$get("/api/auctionTask/findBiddingDetail",{bidTaskId:t}).then(function(t){if(void 0===t)return!1;void 0!==t.list&&(a.detailData=t.list,a.detailNum=t.list.length),a.detailCompany=t.userName,a.detailPrice=t.transactionPrice})},handleToShowCompany:function(t){var a=this,e={totalWeight:t.totalWeight,totalVolume:t.totalVolume,deliverArea:t.deliverArea,pickArea:t.pickArea,taskType:t.taskType,serviceTime:t.serviceTime};"冷藏品"===e.taskType?e.taskType="0":e.taskType="1",this.$get("/api/carrierInfo/findManyCarrierInfo",e).then(function(t){if(void 0===t)return!1;a.companydata=t})},handleToCompany:function(t,a){var e=this,i={bidTaskId:t,userId:a.userId,transactionPrice:a.weightPrice};this.$get("/api/auctionTask/assignCarrier",i).then(function(i){if(!i)return!1;for(var s=0;s<e.taskdata.length;s++)e.taskdata[s].bidTaskId===t&&(e.taskdata[s].userId=a.address,e.taskdata[s].transactionPrice=a.weightPrice,e.taskdata[s].bidStatus="竞拍成功");e.$message({type:"success",message:"已指派此承运商运输此任务单!"})})},refreshData:function(){if(!this.refreshdata)return!1;"task"===this.activeName?this.taskAjax(this.userId,this.pageCode,this.condition):console.log("详情页面不刷新"),this.$emit("refreshed","done")}},mounted:function(){"未登录"===this.userId&&this.$router.push({path:"/login"}),this.taskAjax(this.userId,this.pageCode,this.condition)}},m={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"manage"},[t._m(0),t._v(" "),e("div",{staticClass:"wrap"},[e("el-tabs",{model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"竞价任务单",name:"task"}},[e("search-bar",{on:{searchTask:t.searchTask}}),t._v(" "),e("task-bar",{attrs:{taskdata:t.taskdata,companydata:t.companydata},on:{handleToDetail:t.showDetail,handleToCompany:t.handleToCompany,handleToShowCompany:t.handleToShowCompany}}),t._v(" "),e("pick-data",{attrs:{total:t.tasktotal},on:{handleToPage:t.changePage}})],1),t._v(" "),e("el-tab-pane",{attrs:{label:"竞价详情",name:"detail",disabled:""}},[e("detail-bar",{attrs:{detailOrder:t.detailOrder,detailNum:t.detailNum,detailCompany:t.detailCompany,detailPrice:t.detailPrice,detailData:t.detailData}})],1)],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"title"},[this._v("\n    当前页面:\n    "),a("span",[this._v("竞价管理")])])}]};var b=e("VU/8")(h,m,!1,function(t){e("3Y5c")},"data-v-5b2f945a",null);a.default=b.exports}});